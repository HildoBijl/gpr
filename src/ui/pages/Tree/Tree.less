@import '../../shared/params.less';

.treeContainer {
	cursor: move; // Fallback if grab cursor is unsupported.
	cursor: grab;
	cursor: -moz-grab;
	cursor: -webkit-grab;
	flex-grow: 1;
	font-size: 13px;
	height: 100%;
	overflow: visible;
	position: relative;
	user-select: none;
	width: 100%;

	.tree {
		cursor: pointer;
		position: absolute;

		.chapter {
			border-radius: 16px;
			box-shadow: 0 2px 4px rgba(0,0,0,.26); // Note: these should also be set in the SVG filter effects in the Tree.js file.
			overflow: hidden;
			position: absolute;
			transition: height 0.4s;
			width: 320px;
			z-index: 0;

			.title {
				background: inherit;
				border-radius: 16px 16px 0 0;
				display: flex;
				flex-flow: column nowrap;
				height: 80px;
				justify-content: center;
				position: relative; // This is to make the shadow fall onto the description as well.
				z-index: 2;

				p {
					font-weight: bold;
					line-height: 1.5;
					margin: 0;
					padding: 10px 0; // The horizontal padding will be overwritten by Javascript in Tree.js.
					text-align: center;
				}
			}

			.description {
				border-radius: 0 0 16px 16px;
				display: flex;
				flex-flow: column nowrap;
				font-size: 0.9em;
				justify-content: flex-end;
				padding: 10px 20px 10px 10px;
				position: relative;
				text-align: justify;
				transition: top 0.4s;
				z-index: 1;

				p {
					line-height: 1.15;
					margin: 0 0 6px 0;

					&.study {
						font-weight: bold;
						margin: 0;
						text-align: right;
					}
				}

				&:hover {
					p.study {
						text-decoration: underline;
					}
				}
			}

			&.previousActive {
				z-index: 1;
			}

			&.active {
				z-index: 2;

				.title {
					box-shadow: 0 2px 4px rgba(0,0,0,.26); // Only add a shadow when the description is active, so the shadow falls on the description.
				}

				.description {
					display: block;
				}
			}
		}
	}

	svg {
		cursor: move; // Fallback if grab cursor is unsupported.
		cursor: grab;
		cursor: -moz-grab;
		cursor: -webkit-grab;
		position: absolute;
		z-index: -1;

		.treeLine {
			fill: none;
			stroke-width: 5px;
		}
	}
	
	&.dragging {
		cursor: grabbing;
		cursor: -moz-grabbing;
		cursor: -webkit-grabbing;

		svg {		
			cursor: grabbing;
			cursor: -moz-grabbing;
			cursor: -webkit-grabbing;
		}

		&.invalidClick {
			.tree {
				cursor: grabbing;
				cursor: -moz-grabbing;
				cursor: -webkit-grabbing;
			}
		}
	}
}

// On desktops, apply SVG filters. Do not do so on phones, because SVG filters are computationally heavy and some phone can't take that.
@media @desktop {
	.treeContainer {
		.svg {
			.treeLine {
				filter: url(#shadow);
			}
		}
	}
}

.lightTheme {
	.tree {
		color: #fff;

		.chapter {
			background: #013;

			.description {
				background: #125;
				p.study {
					color: #bbb;
				}
			}
		}
	}
	svg {
		.treeLine {
			stroke: #125;
		}
	}
}
.darkTheme {
	.tree {
		color: #000;

		.chapter {
			background: #adf;

			.description {
				background: #def;
				p.study {
					color: #888;
				}
			}
		}
	}
	svg {
		.treeLine {
			stroke: #adf;
		}
	}
}